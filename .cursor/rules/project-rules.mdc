---
description: Основные правила для проекта MEXC Telegram Bot - криптовалютного бота с поддержкой MEXC и Gate.io
globs: ["src/**/*.py", "main.py", "**/*.py"]
---

# MEXC Telegram Bot - Правила проекта

## Общее описание проекта
Это Telegram бот для получения информации о криптовалютных парах с бирж MEXC и Gate.io. Включает:
- Получение информации о фьючерсных контрактах
- Отображение спотовых цен
- Агрегация данных с нескольких бирж
- Мониторинг fair price алертов через WebSocket
- MarkdownV2 форматирование для Telegram

## Архитектура проекта
Проект использует **Clean Architecture** с разделением на слои:
- `domain/` - бизнес-логика и модели
- `application/` - сервисы приложения (бизнес-логика)
- `infrastructure/` - внешние зависимости (API клиенты, HTTP, WebSocket)
- `core/` - конфигурация, логирование, утилиты
- `bot/` - обработчики команд Telegram

## Основные правила разработки

### Python стиль
- **Версия**: Python 3.11+
- **Typing**: Обязателен во всем коде
- **Форматирование**: PEP8, без фанатизма
- **Импорты**: Стандартные → third-party → локальные
- **Optional**: Только когда None действительно допустим

### Классы и структуры
- **Классы**: Только если есть состояние, бизнес-логика или зависимости
- **Инициализатор**: Не содержит бизнес-логики
- **Dataclass**: Только для чистых контейнеров данных
- **Dependency Injection**: Зависимости передаются через конструктор
- **Интерфейсы**: Явные и понятные

### Архитектурные принципы
- **Один файл = одна ответственность**
- **Нет файла utils.py**
- **Константы вынесены отдельно**
- **Конфигурация вынесена отдельно**
- **Бизнес-логика отделена от ввода/вывода**

### Криптовалютный контекст
- **Биржи**: MEXC (основная), Gate.io (дополнительная)
- **Инструменты**: Фьючерсы, спот, индексы
- **Форматирование**: Цены в USD, объемы в токенах/USD
- **MarkdownV2**: Полное экранирование специальных символов

### Команды бота
- `/start` - Приветственное сообщение
- `/mexc <symbol>` - Информация с MEXC (BTC_USDT)
- `/gate <symbol>` - Информация с Gate.io (BTC_USDT)
- `/cex <symbol>` - Агрегированная информация (BTC)

### Fair Price Мониторинг
- **WebSocket**: Автоматическое переподключение
- **TTL система**: Кулдаун алертов 1 час на символ
- **Спред >7%**: Триггер для алерта
- **MarkdownV2**: Красивое форматирование алертов